V(function(){$(function(){var Category;Category=(function(){function Category(slug){var category;this.slug=slug;category=this;this.page=1;this.max_pages=1;this.pagination=$(".topic-listing").data("pagination");this.topicHTML=Handlebars.compile(this.topicHTMLTemplate());this.paginationHTML=Handlebars.compile(this.paginationHTMLTemplate());this.getPreferences();$("#prefix-filter-show-all").click((function(_this){return function(e){e.preventDefault();return _this.disablePrefixFiltering();};})(this));$(".prefix-filter-action").click(function(e){var element;e.preventDefault();element=$(this);if(element.children("span").hasClass("glyphicon-ok")){element.children("span").removeClass("glyphicon-ok");element.children("span").addClass("glyphicon-remove");}else{element.children("span").removeClass("glyphicon-remove");element.children("span").addClass("glyphicon-ok");}\u000areturn category.setPreferences();});$("nav.pagination-listing").delegate(".change-page","click",function(e){var element;e.preventDefault();element=$(this);$(".page-link-"+category.page).parent().removeClass("active");category.page=parseInt(element.text());return category.refreshTopics();});$("nav.pagination-listing").delegate("#previous-page","click",function(e){var element;e.preventDefault();element=$(this);if(category.page!==1){$(".change-page").parent().removeClass("active");category.page--;return category.refreshTopics();}});$("nav.pagination-listing").delegate("#next-page","click",function(e){var element;e.preventDefault();element=$(this);if(category.page!==category.max_pages){console.log($(".page-link-"+category.page).parent().next().children("a").text());$(".change-page").parent().removeClass("active");category.page++;return category.refreshTopics();}});}\u000aCategory.prototype.paginationHTMLTemplate=function(){return"<ul class=\u005c"pagination\u005c">\u005cn  <li>\u005cn    <a href=\u005c"\u005c" aria-label=\u005c"Previous\u005c" id=\u005c"previous-page\u005c">\u005cn      <span aria-hidden=\u005c"true\u005c">&laquo;</span>\u005cn    </a>\u005cn  </li>\u005cn  {{#each pages}}\u005cn  <li><a href=\u005c"\u005c" class=\u005c"change-page page-link-{{this}}\u005c">{{this}}</a></li>\u005cn  {{/each}}\u005cn  <li>\u005cn    <a href=\u005c"\u005c" aria-label=\u005c"Next\u005c" id=\u005c"next-page\u005c">\u005cn      <span aria-hidden=\u005c"true\u005c">&raquo;</span>\u005cn    </a>\u005cn  </li>\u005cn</ul>";};Category.prototype.topicHTMLTemplate=function(){return"  <div class=\u005c"row\u005c">\u005cn    <div class=\u005c"col-xs-12 col-sm-6\u005c">\u005cn      <span class=\u005c"topic-listing-name\u005c">\u005cn      {{#if prefix}}\u005cn      {{{pre_html}}}{{#if sticky}}<span class=\u005c"glyphicon glyphicon-pushpin\u005c" aria-hidden=\u005c"true\u005c"></span>&nbsp;{{/if}}{{{prefix}}}{{{post_html}}}\u005cn      {{/if}}\u005cn      <a href=\u005c"/t/{{slug}}\u005c">{{title}}</a><br>\u005cn      <span class=\u005c"topic-author\u005c">\u005cn        Started by {{creator}}, {{created}}\u005cn      </span>\u005cn      <span class=\u005c"topic-listing-jumps\u005c">\u005cn        <span class=\u005c"badge\u005c" style=\u005c"\u005c"><a class=\u005c"inherit_colors\u005c" href=\u005c"/t/{{slug}}/page/1\u005c">1</a></span>\u005cn        {{#if last_pages}}\u005cn        <span class=\u005c"badge\u005c" style=\u005c"\u005c">...</span>\u005cn        <span class=\u005c"badge\u005c" style=\u005c"\u005c"><a class=\u005c"inherit_colors\u005c" href=\u005c"/t/{{slug}}/page/{{last_page}}\u005c">{{last_page}}</a></span>\u005cn        {{/if}}\u005cn      </span>\u005cn    </div>\u005cn    <div class=\u005c"col-xs-3 hidden-xs hidden-sm\u005c">\u005cn      <span class=\u005c"topic-listing-recent\u005c">\u005cn        <a href=\u005c"\u005c" class=\u005c"topic-listing-text\u005c">{{post_count}} replies</a>\u005cn        <br>\u005cn        <a href=\u005c"\u005c" class=\u005c"topic-listing-text\u005c">{{view_count}} views</a>\u005cn      </span>\u005cn    </div>\u005cn    <div class=\u005c"col-xs-6 col-sm-3 hidden-xs\u005c">\u005cn      <span class=\u005c"topic-listing-recent-image\u005c">\u005cn        <a href=\u005c"/member/{{author_login_name}}\u005c"><img src=\u005c"{{last_post_author_avatar}}\u005c" width=\u005c"{{last_post_x}}px\u005c" height=\u005c"{{last_post_y}}px\u005c" class=\u005c"avatar-mini\u005c"></a>\u005cn      </span>\u005cn      <span class=\u005c"topic-listing-recent\u005c">\u005cn        <a href=\u005c"/member/{{last_post_by_login_name}}\u005c" class=\u005c"topic-listing-username\u005c">{{last_post_by}}</a>\u005cn        <br>\u005cn        <a href=\u005c"\u005c" class=\u005c"topic-listing-time\u005c">{{last_post_date}}</a>\u005cn      </span>\u005cn    </div>\u005cn  </div>\u005cn</div>\u005cn{{#unless last}}\u005cn<hr>\u005cn{{/unless}}";};Category.prototype.refreshTopics=function(){var new_topic_html;new_topic_html="";return $.post("/category/"+this.slug+"/topics",JSON.stringify({page:this.page,pagination:this.pagination}),(function(_this){return function(data){var i,j,k,len,pages,pagination_html,ref,ref1,results,topic;ref=data.topics;for(i=j=0,len=ref.length;j<len;i=++j){topic=ref[i];if(i===data.topics.length-1){topic.last=true;}\u000atopic.last_page=Math.ceil(topic.last_page);new_topic_html=new_topic_html+_this.topicHTML(topic);}\u000apages=(function(){results=[];for(var k=1,ref1=Math.ceil(data.count/_this.pagination);1<=ref1?k<=ref1:k>=ref1;1<=ref1?k++:k--){results.push(k);}\u000areturn results;}).apply(this);_this.max_pages=pages[pages.length-1];pagination_html=_this.paginationHTML({pages:pages});$(".topic-listing").html(new_topic_html);$(".pagination-listing").html(pagination_html);return $(".page-link-"+_this.page).parent().addClass("active");};})(this));};Category.prototype.disablePrefixFiltering=function(){this.preferences={};$(".prefix-filter-action").children("span").removeClass("glyphicon-remove");$(".prefix-filter-action").children("span").addClass("glyphicon-ok");return this.setPreferences();};Category.prototype.setPreferences=function(){var category;this.preferences={};category=this;if($(".prefix-filter-action").children(".glyphicon-remove").length>0){$(".prefix-filter-action").children(".glyphicon-ok").parent().each(function(){var element;element=$(this);return category.preferences[element.data("prefix")]=1;});}\u000areturn $.post("/category/"+this.slug+"/filter-preferences",JSON.stringify({preferences:this.preferences}),(function(_this){return function(data){return _this.refreshTopics();};})(this));};Category.prototype.getPreferences=function(){return $.get("/category/"+this.slug+"/filter-preferences",(function(_this){return function(data){var prefix;_this.preferences=data.preferences;if($.isEmptyObject(_this.preferences)){_this.disablePrefixFiltering();}else{$(".prefix-filter-action").children("span").removeClass("glyphicon-ok");$(".prefix-filter-action").children("span").addClass("glyphicon-remove");for(prefix in _this.preferences){$("[data-prefix='"+prefix+"']").children("span").removeClass("glyphicon-remove");$("[data-prefix='"+prefix+"']").children("span").addClass("glyphicon-ok");}}\u000areturn _this.refreshTopics();};})(this));};return Category;})();return window.category=new Category($(".topic-listing").data("slug"));});}).call(this);
p1
.