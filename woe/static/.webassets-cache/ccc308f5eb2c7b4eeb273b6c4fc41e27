Vwindow.Modernizr=function(a,b,c){function z(a){j.cssText=a}function A(a,b){return z(m.join(a+";")+(b||""))}function B(a,b){return typeof a===b}function C(a,b){return!!~(""+a).indexOf(b)}function D(a,b){for(var d in a){var e=a[d];if(!C(e,"-")&&j[e]!==c)return b=="pfx"?e:!0}return!1}function E(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:B(f,"function")?f.bind(d||b):f}return!1}function F(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+o.join(d+" ")+d).split(" ");return B(b,"string")||B(b,"undefined")?D(e,b):(e=(a+" "+p.join(d+" ")+d).split(" "),E(e,b,c))}var d="2.6.2",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k,l={}.toString,m=" -webkit- -moz- -o- -ms- ".split(" "),n="Webkit Moz O ms",o=n.split(" "),p=n.toLowerCase().split(" "),q={},r={},s={},t=[],u=t.slice,v,w=function(a,c,d,e){var f,i,j,k,l=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:h+(d+1),l.appendChild(j);return f=["&#173;",'<style id="s',h,'">',a,"</style>"].join(""),l.id=h,(m?l:n).innerHTML+=f,n.appendChild(l),m||(n.style.background="",n.style.overflow="hidden",k=g.style.overflow,g.style.overflow="hidden",g.appendChild(n)),i=c(l,a),m?l.parentNode.removeChild(l):(n.parentNode.removeChild(n),g.style.overflow=k),!!i},x={}.hasOwnProperty,y;!B(x,"undefined")&&!B(x.call,"undefined")?y=function(a,b){return x.call(a,b)}:y=function(a,b){return b in a&&B(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=u.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(u.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(u.call(arguments)))};return e}),q.csstransforms=function(){return!!F("transform")},q.csstransforms3d=function(){var a=!!F("perspective");return a&&"webkitPerspective"in g.style&&w("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(b,c){a=b.offsetLeft===9&&b.offsetHeight===3}),a},q.csstransitions=function(){return F("transition")};for(var G in q)y(q,G)&&(v=G.toLowerCase(),e[v]=q[G](),t.push((e[v]?"":"no-")+v));return e.addTest=function(a,b){if(typeof a=="object")for(var d in a)y(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof f!="undefined"&&f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b}return e},z(""),i=k=null,e._version=d,e._prefixes=m,e._domPrefixes=p,e._cssomPrefixes=o,e.testProp=function(a){return D([a])},e.testAllProps=F,e.testStyles=w,e.prefixed=function(a,b,c){return b?F(a,b,c):F(a,"pfx")},g.className=g.className.replace(/(^|\u005cs)no-js(\u005cs|$)/,"$1$2")+(f?" js "+t.join(" "):""),e}(this,this.document);(function(factory){if(typeof define==='function'&&define.amd){define(['jquery','modernizr'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'),window.Modernizr);}else{window.Shuffle=factory(window.jQuery,window.Modernizr);}})(function($,Modernizr,undefined){'use strict';if(typeof Modernizr!=='object'){throw new Error('Shuffle.js requires Modernizr.\u005cn'+'http://vestride.github.io/Shuffle/#dependencies');}\u000afunction dashify(prop){if(!prop){return'';}\u000areturn prop.replace(/([A-Z])/g,function(str,m1){return'-'+m1.toLowerCase();}).replace(/^ms-/,'-ms-');}\u000avar TRANSITION=Modernizr.prefixed('transition');var TRANSITION_DELAY=Modernizr.prefixed('transitionDelay');var TRANSITION_DURATION=Modernizr.prefixed('transitionDuration');var TRANSITIONEND={'WebkitTransition':'webkitTransitionEnd','transition':'transitionend'}[TRANSITION];var TRANSFORM=Modernizr.prefixed('transform');var CSS_TRANSFORM=dashify(TRANSFORM);var CAN_TRANSITION_TRANSFORMS=Modernizr.csstransforms&&Modernizr.csstransitions;var HAS_TRANSFORMS_3D=Modernizr.csstransforms3d;var HAS_COMPUTED_STYLE=!!window.getComputedStyle;var SHUFFLE='shuffle';var ALL_ITEMS='all';var FILTER_ATTRIBUTE_KEY='groups';var DEFAULT_SCALE=1;var CONCEALED_SCALE=0.001;function throttle(func,wait,options){var context,args,result;var timeout=null;var previous=0;options=options||{};var later=function(){previous=options.leading===false?0:$.now();timeout=null;result=func.apply(context,args);context=args=null;};return function(){var now=$.now();if(!previous&&options.leading===false){previous=now;}\u000avar remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);context=args=null;}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining);}\u000areturn result;};}\u000afunction each(obj,iterator,context){for(var i=0,length=obj.length;i<length;i++){if(iterator.call(context,obj[i],i,obj)==={}){return;}}}\u000afunction defer(fn,context,wait){return setTimeout($.proxy(fn,context),wait);}\u000afunction arrayMax(array){return Math.max.apply(Math,array);}\u000afunction arrayMin(array){return Math.min.apply(Math,array);}\u000afunction getNumber(value){return $.isNumeric(value)?value:0;}\u000avar getStyles=window.getComputedStyle||function(){};var Point=function(x,y){this.x=getNumber(x);this.y=getNumber(y);};Point.equals=function(a,b){return a.x===b.x&&a.y===b.y;};var COMPUTED_SIZE_INCLUDES_PADDING=(function(){if(!HAS_COMPUTED_STYLE){return false;}\u000avar parent=document.body||document.documentElement;var e=document.createElement('div');e.style.cssText='width:10px;padding:2px;'+'-webkit-box-sizing:border-box;box-sizing:border-box;';parent.appendChild(e);var width=getStyles(e,null).width;var ret=width==='10px';parent.removeChild(e);return ret;}());var id=0;var $window=$(window);var Shuffle=function(element,options){options=options||{};$.extend(this,Shuffle.options,options,Shuffle.settings);this.$el=$(element);this.element=element;this.unique='shuffle_'+id++;this._fire(Shuffle.EventType.LOADING);this._init();defer(function(){this.initialized=true;this._fire(Shuffle.EventType.DONE);},this,16);};Shuffle.EventType={LOADING:'loading',DONE:'done',LAYOUT:'layout',REMOVED:'removed'};Shuffle.ClassName={BASE:SHUFFLE,SHUFFLE_ITEM:'shuffle-item',FILTERED:'filtered',CONCEALED:'concealed'};Shuffle.options={group:ALL_ITEMS,speed:250,easing:'ease-out',itemSelector:'',sizer:null,gutterWidth:0,columnWidth:0,delimeter:null,buffer:0,columnThreshold:HAS_COMPUTED_STYLE?0.01:0.1,initialSort:null,throttle:throttle,throttleTime:300,sequentialFadeDelay:150,supported:CAN_TRANSITION_TRANSFORMS};Shuffle.settings={useSizer:false,itemCss:{position:'absolute',top:0,left:0,visibility:'visible'},revealAppendedDelay:300,lastSort:{},lastFilter:ALL_ITEMS,enabled:true,destroyed:false,initialized:false,_animations:[],_transitions:[],_isMovementCanceled:false,styleQueue:[]};Shuffle.Point=Point;Shuffle._getItemTransformString=function(point,scale){if(HAS_TRANSFORMS_3D){return'translate3d('+point.x+'px, '+point.y+'px, 0) scale3d('+scale+', '+scale+', 1)';}else{return'translate('+point.x+'px, '+point.y+'px) scale('+scale+')';}};Shuffle._getNumberStyle=function(element,style,styles){if(HAS_COMPUTED_STYLE){styles=styles||getStyles(element,null);var value=Shuffle._getFloat(styles[style]);if(!COMPUTED_SIZE_INCLUDES_PADDING&&style==='width'){value+=Shuffle._getFloat(styles.paddingLeft)+\u000aShuffle._getFloat(styles.paddingRight)+\u000aShuffle._getFloat(styles.borderLeftWidth)+\u000aShuffle._getFloat(styles.borderRightWidth);}else if(!COMPUTED_SIZE_INCLUDES_PADDING&&style==='height'){value+=Shuffle._getFloat(styles.paddingTop)+\u000aShuffle._getFloat(styles.paddingBottom)+\u000aShuffle._getFloat(styles.borderTopWidth)+\u000aShuffle._getFloat(styles.borderBottomWidth);}\u000areturn value;}else{return Shuffle._getFloat($(element).css(style));}};Shuffle._getFloat=function(value){return getNumber(parseFloat(value));};Shuffle._getOuterWidth=function(element,includeMargins){var styles=getStyles(element,null);var width=Shuffle._getNumberStyle(element,'width',styles);if(includeMargins){var marginLeft=Shuffle._getNumberStyle(element,'marginLeft',styles);var marginRight=Shuffle._getNumberStyle(element,'marginRight',styles);width+=marginLeft+marginRight;}\u000areturn width;};Shuffle._getOuterHeight=function(element,includeMargins){var styles=getStyles(element,null);var height=Shuffle._getNumberStyle(element,'height',styles);if(includeMargins){var marginTop=Shuffle._getNumberStyle(element,'marginTop',styles);var marginBottom=Shuffle._getNumberStyle(element,'marginBottom',styles);height+=marginTop+marginBottom;}\u000areturn height;};Shuffle._skipTransition=function(element,callback,context){var duration=element.style[TRANSITION_DURATION];element.style[TRANSITION_DURATION]='0ms';callback.call(context);var reflow=element.offsetWidth;reflow=null;element.style[TRANSITION_DURATION]=duration;};Shuffle.prototype._init=function(){this.$items=this._getItems();this.sizer=this._getElementOption(this.sizer);if(this.sizer){this.useSizer=true;}\u000athis.$el.addClass(Shuffle.ClassName.BASE);this._initItems();$window.on('resize.'+SHUFFLE+'.'+this.unique,this._getResizeFunction());var containerCSS=this.$el.css(['position','overflow']);var containerWidth=Shuffle._getOuterWidth(this.element);this._validateStyles(containerCSS);this._setColumns(containerWidth);this.shuffle(this.group,this.initialSort);if(this.supported){defer(function(){this._setTransitions();this.element.style[TRANSITION]='height '+this.speed+'ms '+this.easing;},this);}};Shuffle.prototype._getResizeFunction=function(){var resizeFunction=$.proxy(this._onResize,this);return this.throttle?this.throttle(resizeFunction,this.throttleTime):resizeFunction;};Shuffle.prototype._getElementOption=function(option){if(typeof option==='string'){return this.$el.find(option)[0]||null;}else if(option&&option.nodeType&&option.nodeType===1){return option;}else if(option&&option.jquery){return option[0];}\u000areturn null;};Shuffle.prototype._validateStyles=function(styles){if(styles.position==='static'){this.element.style.position='relative';}\u000aif(styles.overflow!=='hidden'){this.element.style.overflow='hidden';}};Shuffle.prototype._filter=function(category,$collection){category=category||this.lastFilter;$collection=$collection||this.$items;var set=this._getFilteredSets(category,$collection);this._toggleFilterClasses(set.filtered,set.concealed);this.lastFilter=category;if(typeof category==='string'){this.group=category;}\u000areturn set.filtered;};Shuffle.prototype._getFilteredSets=function(category,$items){var $filtered=$();var $concealed=$();if(category===ALL_ITEMS){$filtered=$items;}else{each($items,function(el){var $item=$(el);if(this._doesPassFilter(category,$item)){$filtered=$filtered.add($item);}else{$concealed=$concealed.add($item);}},this);}\u000areturn{filtered:$filtered,concealed:$concealed};};Shuffle.prototype._doesPassFilter=function(category,$item){if($.isFunction(category)){return category.call($item[0],$item,this);}else{var groups=$item.data(FILTER_ATTRIBUTE_KEY);var keys=this.delimeter&&!$.isArray(groups)?groups.split(this.delimeter):groups;return $.inArray(category,keys)>-1;}};Shuffle.prototype._toggleFilterClasses=function($filtered,$concealed){$filtered.removeClass(Shuffle.ClassName.CONCEALED).addClass(Shuffle.ClassName.FILTERED);$concealed.removeClass(Shuffle.ClassName.FILTERED).addClass(Shuffle.ClassName.CONCEALED);};Shuffle.prototype._initItems=function($items){$items=$items||this.$items;$items.addClass([Shuffle.ClassName.SHUFFLE_ITEM,Shuffle.ClassName.FILTERED].join(' '));$items.css(this.itemCss).data('point',new Point()).data('scale',DEFAULT_SCALE);};Shuffle.prototype._updateItemCount=function(){this.visibleItems=this._getFilteredItems().length;};Shuffle.prototype._setTransition=function(element){element.style[TRANSITION]=CSS_TRANSFORM+' '+this.speed+'ms '+\u000athis.easing+', opacity '+this.speed+'ms '+this.easing;};Shuffle.prototype._setTransitions=function($items){$items=$items||this.$items;each($items,function(el){this._setTransition(el);},this);};Shuffle.prototype._setSequentialDelay=function($collection){if(!this.supported){return;}\u000aeach($collection,function(el,i){el.style[TRANSITION_DELAY]='0ms,'+((i+1)*this.sequentialFadeDelay)+'ms';},this);};Shuffle.prototype._getItems=function(){return this.$el.children(this.itemSelector);};Shuffle.prototype._getFilteredItems=function(){return this.$items.filter('.'+Shuffle.ClassName.FILTERED);};Shuffle.prototype._getConcealedItems=function(){return this.$items.filter('.'+Shuffle.ClassName.CONCEALED);};Shuffle.prototype._getColumnSize=function(containerWidth,gutterSize){var size;if($.isFunction(this.columnWidth)){size=this.columnWidth(containerWidth);}else if(this.useSizer){size=Shuffle._getOuterWidth(this.sizer);}else if(this.columnWidth){size=this.columnWidth;}else if(this.$items.length>0){size=Shuffle._getOuterWidth(this.$items[0],true);}else{size=containerWidth;}\u000aif(size===0){size=containerWidth;}\u000areturn size+gutterSize;};Shuffle.prototype._getGutterSize=function(containerWidth){var size;if($.isFunction(this.gutterWidth)){size=this.gutterWidth(containerWidth);}else if(this.useSizer){size=Shuffle._getNumberStyle(this.sizer,'marginLeft');}else{size=this.gutterWidth;}\u000areturn size;};Shuffle.prototype._setColumns=function(theContainerWidth){var containerWidth=theContainerWidth||Shuffle._getOuterWidth(this.element);var gutter=this._getGutterSize(containerWidth);var columnWidth=this._getColumnSize(containerWidth,gutter);var calculatedColumns=(containerWidth+gutter)/columnWidth;if(Math.abs(Math.round(calculatedColumns)-calculatedColumns)<this.columnThreshold){calculatedColumns=Math.round(calculatedColumns);}\u000athis.cols=Math.max(Math.floor(calculatedColumns),1);this.containerWidth=containerWidth;this.colWidth=columnWidth;};Shuffle.prototype._setContainerSize=function(){this.$el.css('height',this._getContainerSize());};Shuffle.prototype._getContainerSize=function(){return arrayMax(this.positions);};Shuffle.prototype._fire=function(name,args){this.$el.trigger(name+'.'+SHUFFLE,args&&args.length?args:[this]);};Shuffle.prototype._resetCols=function(){var i=this.cols;this.positions=[];while(i--){this.positions.push(0);}};Shuffle.prototype._layout=function(items,isOnlyPosition){each(items,function(item){this._layoutItem(item,!!isOnlyPosition);},this);this._processStyleQueue();this._setContainerSize();};Shuffle.prototype._layoutItem=function(item,isOnlyPosition){var $item=$(item);var itemData=$item.data();var currPos=itemData.point;var currScale=itemData.scale;var itemSize={width:Shuffle._getOuterWidth(item,true),height:Shuffle._getOuterHeight(item,true)};var pos=this._getItemPosition(itemSize);if(Point.equals(currPos,pos)&&currScale===DEFAULT_SCALE){return;}\u000aitemData.point=pos;itemData.scale=DEFAULT_SCALE;this.styleQueue.push({$item:$item,point:pos,scale:DEFAULT_SCALE,opacity:isOnlyPosition?0:1,skipTransition:isOnlyPosition||this.speed===0,callfront:function(){if(!isOnlyPosition){$item.css('visibility','visible');}},callback:function(){if(isOnlyPosition){$item.css('visibility','hidden');}}});};Shuffle.prototype._getItemPosition=function(itemSize){var columnSpan=this._getColumnSpan(itemSize.width,this.colWidth,this.cols);var setY=this._getColumnSet(columnSpan,this.cols);var shortColumnIndex=this._getShortColumn(setY,this.buffer);var point=new Point(Math.round(this.colWidth*shortColumnIndex),Math.round(setY[shortColumnIndex]));var setHeight=setY[shortColumnIndex]+itemSize.height;var setSpan=this.cols+1-setY.length;for(var i=0;i<setSpan;i++){this.positions[shortColumnIndex+i]=setHeight;}\u000areturn point;};Shuffle.prototype._getColumnSpan=function(itemWidth,columnWidth,columns){var columnSpan=itemWidth/columnWidth;if(Math.abs(Math.round(columnSpan)-columnSpan)<this.columnThreshold){columnSpan=Math.round(columnSpan);}\u000areturn Math.min(Math.ceil(columnSpan),columns);};Shuffle.prototype._getColumnSet=function(columnSpan,columns){if(columnSpan===1){return this.positions;}else{var groupCount=columns+1-columnSpan;var groupY=[];for(var i=0;i<groupCount;i++){groupY[i]=arrayMax(this.positions.slice(i,i+columnSpan));}\u000areturn groupY;}};Shuffle.prototype._getShortColumn=function(positions,buffer){var minPosition=arrayMin(positions);for(var i=0,len=positions.length;i<len;i++){if(positions[i]>=minPosition-buffer&&positions[i]<=minPosition+buffer){return i;}}\u000areturn 0;};Shuffle.prototype._shrink=function($collection){var $concealed=$collection||this._getConcealedItems();each($concealed,function(item){var $item=$(item);var itemData=$item.data();if(itemData.scale===CONCEALED_SCALE){return;}\u000aitemData.scale=CONCEALED_SCALE;this.styleQueue.push({$item:$item,point:itemData.point,scale:CONCEALED_SCALE,opacity:0,callback:function(){$item.css('visibility','hidden');}});},this);};Shuffle.prototype._onResize=function(){if(!this.enabled||this.destroyed){return;}\u000avar containerWidth=Shuffle._getOuterWidth(this.element);if(containerWidth===this.containerWidth){return;}\u000athis.update();};Shuffle.prototype._getStylesForTransition=function(opts){var styles={opacity:opts.opacity};if(this.supported){styles[TRANSFORM]=Shuffle._getItemTransformString(opts.point,opts.scale);}else{styles.left=opts.point.x;styles.top=opts.point.y;}\u000areturn styles;};Shuffle.prototype._transition=function(opts){var styles=this._getStylesForTransition(opts);this._startItemAnimation(opts.$item,styles,opts.callfront||$.noop,opts.callback||$.noop);};Shuffle.prototype._startItemAnimation=function($item,styles,callfront,callback){var _this=this;function handleTransitionEnd(evt){if(evt.target===evt.currentTarget){$(evt.target).off(TRANSITIONEND,handleTransitionEnd);_this._removeTransitionReference(reference);callback();}}\u000avar reference={$element:$item,handler:handleTransitionEnd};callfront();if(!this.initialized){$item.css(styles);callback();return;}\u000aif(this.supported){$item.css(styles);$item.on(TRANSITIONEND,handleTransitionEnd);this._transitions.push(reference);}else{var anim=$item.stop(true).animate(styles,this.speed,'swing',callback);this._animations.push(anim.promise());}};Shuffle.prototype._processStyleQueue=function(noLayout){if(this.isTransitioning){this._cancelMovement();}\u000avar $transitions=$();each(this.styleQueue,function(transitionObj){if(transitionObj.skipTransition){this._styleImmediately(transitionObj);}else{$transitions=$transitions.add(transitionObj.$item);this._transition(transitionObj);}},this);if($transitions.length>0&&this.initialized&&this.speed>0){this.isTransitioning=true;if(this.supported){this._whenCollectionDone($transitions,TRANSITIONEND,this._movementFinished);}else{this._whenAnimationsDone(this._movementFinished);}}else if(!noLayout){defer(this._layoutEnd,this);}\u000athis.styleQueue.length=0;};Shuffle.prototype._cancelMovement=function(){if(this.supported){each(this._transitions,function(transition){transition.$element.off(TRANSITIONEND,transition.handler);});}else{this._isMovementCanceled=true;this.$items.stop(true);this._isMovementCanceled=false;}\u000athis._transitions.length=0;this.isTransitioning=false;};Shuffle.prototype._removeTransitionReference=function(ref){var indexInArray=$.inArray(ref,this._transitions);if(indexInArray>-1){this._transitions.splice(indexInArray,1);}};Shuffle.prototype._styleImmediately=function(opts){Shuffle._skipTransition(opts.$item[0],function(){opts.$item.css(this._getStylesForTransition(opts));},this);};Shuffle.prototype._movementFinished=function(){this.isTransitioning=false;this._layoutEnd();};Shuffle.prototype._layoutEnd=function(){this._fire(Shuffle.EventType.LAYOUT);};Shuffle.prototype._addItems=function($newItems,addToEnd,isSequential){this._initItems($newItems);this._setTransitions($newItems);this.$items=this._getItems();this._shrink($newItems);each(this.styleQueue,function(transitionObj){transitionObj.skipTransition=true;});this._processStyleQueue(true);if(addToEnd){this._addItemsToEnd($newItems,isSequential);}else{this.shuffle(this.lastFilter);}};Shuffle.prototype._addItemsToEnd=function($newItems,isSequential){var $passed=this._filter(null,$newItems);var passed=$passed.get();this._updateItemCount();this._layout(passed,true);if(isSequential&&this.supported){this._setSequentialDelay(passed);}\u000athis._revealAppended(passed);};Shuffle.prototype._revealAppended=function(newFilteredItems){defer(function(){each(newFilteredItems,function(el){var $item=$(el);this._transition({$item:$item,opacity:1,point:$item.data('point'),scale:DEFAULT_SCALE});},this);this._whenCollectionDone($(newFilteredItems),TRANSITIONEND,function(){$(newFilteredItems).css(TRANSITION_DELAY,'0ms');this._movementFinished();});},this,this.revealAppendedDelay);};Shuffle.prototype._whenCollectionDone=function($collection,eventName,callback){var done=0;var items=$collection.length;var self=this;function handleEventName(evt){if(evt.target===evt.currentTarget){$(evt.target).off(eventName,handleEventName);done++;if(done===items){self._removeTransitionReference(reference);callback.call(self);}}}\u000avar reference={$element:$collection,handler:handleEventName};$collection.on(eventName,handleEventName);this._transitions.push(reference);};Shuffle.prototype._whenAnimationsDone=function(callback){$.when.apply(null,this._animations).always($.proxy(function(){this._animations.length=0;if(!this._isMovementCanceled){callback.call(this);}},this));};Shuffle.prototype.shuffle=function(category,sortObj){if(!this.enabled){return;}\u000aif(!category){category=ALL_ITEMS;}\u000athis._filter(category);this._updateItemCount();this._shrink();this.sort(sortObj);};Shuffle.prototype.sort=function(opts){if(this.enabled){this._resetCols();var sortOptions=opts||this.lastSort;var items=this._getFilteredItems().sorted(sortOptions);this._layout(items);this.lastSort=sortOptions;}};Shuffle.prototype.update=function(isOnlyLayout){if(this.enabled){if(!isOnlyLayout){this._setColumns();}\u000athis.sort();}};Shuffle.prototype.layout=function(){this.update(true);};Shuffle.prototype.appended=function($newItems,addToEnd,isSequential){this._addItems($newItems,addToEnd===true,isSequential!==false);};Shuffle.prototype.disable=function(){this.enabled=false;};Shuffle.prototype.enable=function(isUpdateLayout){this.enabled=true;if(isUpdateLayout!==false){this.update();}};Shuffle.prototype.remove=function($collection){if(!$collection.length||!$collection.jquery){return;}\u000afunction handleRemoved(){$collection.remove();this.$items=this._getItems();this._updateItemCount();this._fire(Shuffle.EventType.REMOVED,[$collection,this]);$collection=null;}\u000athis._toggleFilterClasses($(),$collection);this._shrink($collection);this.sort();this.$el.one(Shuffle.EventType.LAYOUT+'.'+SHUFFLE,$.proxy(handleRemoved,this));};Shuffle.prototype.destroy=function(){$window.off('.'+this.unique);this.$el.removeClass(SHUFFLE).removeAttr('style').removeData(SHUFFLE);this.$items.removeAttr('style').removeData('point').removeData('scale').removeClass([Shuffle.ClassName.CONCEALED,Shuffle.ClassName.FILTERED,Shuffle.ClassName.SHUFFLE_ITEM].join(' '));this.$items=null;this.$el=null;this.sizer=null;this.element=null;this._transitions=null;this.destroyed=true;};$.fn.shuffle=function(opts){var args=Array.prototype.slice.call(arguments,1);return this.each(function(){var $this=$(this);var shuffle=$this.data(SHUFFLE);if(!shuffle){shuffle=new Shuffle(this,opts);$this.data(SHUFFLE,shuffle);}else if(typeof opts==='string'&&shuffle[opts]){shuffle[opts].apply(shuffle,args);}});};function randomize(array){var tmp,current;var top=array.length;if(!top){return array;}\u000awhile(--top){current=Math.floor(Math.random()*(top+1));tmp=array[current];array[current]=array[top];array[top]=tmp;}\u000areturn array;}\u000a$.fn.sorted=function(options){var opts=$.extend({},$.fn.sorted.defaults,options);var arr=this.get();var revert=false;if(!arr.length){return[];}\u000aif(opts.randomize){return randomize(arr);}\u000aif($.isFunction(opts.by)){arr.sort(function(a,b){if(revert){return 0;}\u000avar valA=opts.by($(a));var valB=opts.by($(b));if(valA===undefined&&valB===undefined){revert=true;return 0;}\u000aif(valA<valB||valA==='sortFirst'||valB==='sortLast'){return-1;}\u000aif(valA>valB||valA==='sortLast'||valB==='sortFirst'){return 1;}\u000areturn 0;});}\u000aif(revert){return this.get();}\u000aif(opts.reverse){arr.reverse();}\u000areturn arr;};$.fn.sorted.defaults={reverse:false,by:null,randomize:false};return Shuffle;});(function(){var indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i;}return-1;};$(function(){var Dashboard;Dashboard=(function(){function Dashboard(){var $grid,_panel,socket;$grid=$('#dashboard-container');window.grid=$grid;$grid.shuffle({speed:0});this.categories={};this.notificationTemplate=Handlebars.compile(this.notificationHTML());this.panelTemplate=Handlebars.compile(this.panelHTML());this.dashboard_container=$("#dashboard-container");this.category_names={topic:"Topics",pm:"Private Messages",mention:"Mentioned",topic_reply:"Topic Replies",boop:"Boops",mod:"Moderation",status:"Status Updates",new_member:"New Members",announcement:"Announcements",profile_comment:"Profile Comments",rules_updated:"Rule Update",faqs:"FAQs Updated",user_activity:"Followed:User Activity",streaming:"Streaming",other:"Other"};this.buildDashboard();_panel=this;socket=io.connect('http://'+document.domain+':3000'+'');socket.on("notify",function(data){var ref;if(ref=window.woe_is_me,indexOf.call(data.users,ref)>=0){$(".nothing-new").remove();_panel.addToPanel(data,true);return _panel.setPanelDates();}});$("#dashboard-container").delegate(".ack_all","click",function(e){var panel;e.preventDefault();panel=$("#"+$(this).data("panel"));return $.post("/dashboard/ack_category",JSON.stringify({category:panel.attr("id")}),(function(_this){return function(data){if(data.success!=null){panel.remove();return _panel.isPanelEmpty();}};})(this));});$("#dashboard-container").delegate(".ack_single","click",function(e){var notification,panel,panel_notifs;e.preventDefault();notification=$("#"+$(this).data("notification"));panel_notifs=$("#notifs-"+$(this).data("panel"));panel=$("#"+$(this).data("panel"));return $.post("/dashboard/ack_notification",JSON.stringify({notification:notification.attr("id")}),(function(_this){return function(data){if(data.success!=null){if(panel_notifs.children().length<2){panel.remove();return _panel.isPanelEmpty();}else{notification.remove();return _panel.isPanelEmpty();}}};})(this));});}\u000aDashboard.prototype.isPanelEmpty=function(){if($(".dashboard-panel").length===0){return $("#dashboard-container").before("<p class=\u005c"nothing-new\u005c">No new notifications, yet.</p>");}else{return $(".nothing-new").remove();}};Dashboard.prototype.setPanelDates=function(){$(".dashboard-panel").children(".panel").children("ul").each(function(){var element,first_timestamp;element=$(this);first_timestamp=element.children("li").first().data("stamp");return element.parent().parent().data("stamp",first_timestamp);});return setTimeout(function(){var sort_opts;$("#dashboard-container").shuffle('appended',$(".dashboard-panel"));$("#dashboard-container").shuffle("update");sort_opts={reverse:true,by:function(el){return el.data("stamp");}};return $("#dashboard-container").shuffle("sort",sort_opts);},100);};Dashboard.prototype.addToPanel=function(notification,live){var category_element,count,existing_notification,panel,ref;if(live==null){live=false;}\u000acategory_element=$("#notifs-"+notification.category);if(category_element.length===0){panel={panel_id:notification.category,panel_title:this.category_names[notification.category]};this.dashboard_container.append(this.panelTemplate(panel));category_element=$("#notifs-"+notification.category);}\u000aif(!live){if(((ref=notification.content)!=null?ref._ref:void 0)!=null){notification.reference=notification.content._ref;}else{notification.reference="";}}\u000anotification._member_name=notification.member_name.replace(/\u005cs/g,"");existing_notification=$(".ref-"+notification.reference+"-"+notification.category+"-"+notification._member_name);if(existing_notification.length>0&&notification.reference!==""){count=parseInt(existing_notification.data("count"));count=count+1;if(!existing_notification.children("media-left").is(":visible")){existing_notification.children(".media-left").show();}\u000aexisting_notification.data("count",count);existing_notification.data("stamp",notification.stamp);existing_notification.children(".media-left").children(".badge").text(count);existing_notification.find(".m-name").attr("href","/members/"+notification.member_name);existing_notification.find(".m-name").text(notification.member_disp_name);existing_notification.find(".m-time").text(notification.time);existing_notification.find(".m-title").text(notification.text);existing_notification.find(".m-title").attr("href",notification.url);if(live){if(existing_notification[0]!==category_element.children().first()[0]){return category_element.prepend(existing_notification);}}}else{if(live){return category_element.prepend(this.notificationTemplate(notification));}else{return category_element.append(this.notificationTemplate(notification));}}};Dashboard.prototype.buildDashboard=function(){return $.post("/dashboard/notifications",{},(function(_this){return function(response){var i,len,notification,ref;ref=response.notifications;for(i=0,len=ref.length;i<len;i++){notification=ref[i];_this.addToPanel(notification);}\u000a_this.isPanelEmpty();return _this.setPanelDates();};})(this));};Dashboard.prototype.notificationHTML=function(){return"<li class=\u005c"list-group-item ref-{{reference}}-{{category}}-{{_member_name}}\u005c" id=\u005c"{{_id}}\u005c" data-stamp=\u005c"{{stamp}}\u005c" data-count=\u005c"1\u005c">\u005cn  <div class=\u005c"media-left\u005c" style=\u005c"display: none;\u005c"><span class=\u005c"badge\u005c"></span></div>\u005cn  <div class=\u005c"media-body\u005c">\u005cn    <a href=\u005c"{{url}}\u005c" class=\u005c"m-title\u005c">{{text}}</a><button class=\u005c"close ack_single\u005c" data-notification=\u005c"{{_id}}\u005c" data-panel=\u005c"{{category}}\u005c">&times;</button>\u005cn    <p class=\u005c"text-muted\u005c"> by <a href=\u005c"/members/{{member_name}}\u005c" class=\u005c"m-name\u005c">{{member_disp_name}}</a> - <span class=\u005c"m-time\u005c">{{time}}</span></p>\u005cn  </div>\u005cn</li>";};Dashboard.prototype.panelHTML=function(){return"<div class=\u005c"col-sm-6 col-md-4 dashboard-panel\u005c" id=\u005c"{{panel_id}}\u005c">\u005cn  <div class=\u005c"panel panel-default\u005c">\u005cn    <div class=\u005c"panel-heading\u005c">\u005cn      <span>{{panel_title}}</span>\u005cn      <button class=\u005c"close ack_all\u005c" data-panel=\u005c"{{panel_id}}\u005c">&times;</button>\u005cn    </div>\u005cn    <ul class=\u005c"list-group panel-body\u005c" id=\u005c"notifs-{{panel_id}}\u005c">\u005cn    </ul>\u005cn  </div>\u005cn</div>";};return Dashboard;})();return window.woeDashboard=new Dashboard;});}).call(this);
p1
.